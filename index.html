<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  
  
  <title>D3.js Boilerplate with Select2</title>

  
  
  <!-- jQuery is required by Select2 -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

  <link
    href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css"
    rel="stylesheet"
  />
  
  
  <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>

  <style>
    
    #sidebar{
      position: fixed;
      top: 0;
      right: 0;
      height: 100%;
      width: 250px;
      background: green;
      color: #fff;
      transform: translateX(100%);
      transition: transform 0.3s ease;
      padding-top: 100px;
      padding-left: 25px;
      padding-bottom: 25px;
      margin: 0;
      
    }
    
    #sidebar.open {
      transform: translateX(0%);
    }
    
    
    
    body {
      font-family: sans-serif;
      overflow-x: hidden;
    }

    .chart-container {
      width: 100%;
      display: flex;
      justify-content: center;
    }

    svg {
      background-color: #f9f9f9;
      border: 1px solid #ccc;
    }

    .select-container {
      display: flex;
      flex-direction: column;
      justify-content: center;
      column-gap: 10px;
      margin-top: 20px;
    }

    
    #Select_button:hover {
      cursor: pointer;
    }
    
    
    #algo-select, #algo-type-select  {
      width: 200px;
    }
  </style>
  <script src="https://d3js.org/d3.v7.min.js"></script>
</head>

<body>
  <div style="display: flex; justify-content: flex-end;"> 
    
    <div style="background-color: green; width: 100px; height: 30px; text-align: center; padding-top:10px; border:2px black solid; color: white;  z-index: 1000;" id="Select_button">
      <b>âš™ Settings </b>
    </div>
  </div>
  <div>
  <h2 style="text-align: center;">ClusterUI</h2>
</div>
  <div class="chart-container">
    <svg id="chart" width="75%" height="50%"></svg>
  </div>
  
  
  

  <div style="display:flex; flex-direction:column; gap: 20px;" id="sidebar">
    <select id="algo-select">
      <option value="KM">K-Means</option>
      <option value="DB">DBSCAN</option>
    </select>
    
    
    <select id="algo-type-select">
      <option value="Self-made"><b>Self-Made</b></option>
      <option value="CPU"><b>CPU</b></option>
      <option value="GPU"><b>GPU</b></option>
    </select>
    
    <div>
      
    
      
     
      
      <b>Epsilon:  </b>
    <input type="range" id="slider" min="0" max="100" value="50" />
    <span id="sliderVal"> 50 </span>
    </div>
    
    <div>
      <b> MinPts: </b>
      <input type="text" value="3" id="minPts"> </input>
    </div>
    <div style="display:flex; flex-direction:row; gap:10px;">
      <b>File: </b>
    <input type="file" accept=".json" id="filer">   
  </div>
  <div>
    <b>Manual Input (Array format): </b>
    <input type="text" id="manual_input"> </input>
    
  </div>
  <div>
    <button id="submission" type="submit"> Submit </button>
  </div>
  </div>

  <script>
   
   $(document).ready(function () {
  $('#algo-select').select2({
    minimumResultsForSearch: Infinity, 
  });

  $('#algo-type-select').select2({
    minimumResultsForSearch: Infinity, 
  });

});
    
     
    
    
    const slider_1 = document.getElementById("slider");
    
    const slider_2 = document.getElementById("sliderVal");
    
    const button_1 = document.getElementById("Select_button");
    
    button_1.addEventListener("click",(event) => {
      
      if(button_1.style.backgroundColor === "rgb(255, 71, 76)"){
        
         button_1.style.backgroundColor = "green";
        
          sidebar.classList.toggle('open');
        
         }
      else{
        button_1.style.backgroundColor = "green";
        sidebar.classList.toggle('open');
      }
      
      
    });
    
    
    slider_1.addEventListener("change", function(event) {
      
  slider_2.innerHTML = slider_1.value;
});
    
    const submit_button = document.getElementById("submission");
    
    submit_button.addEventListener("click", function(event) {
  const algorithm = document.getElementById("algo-select").value;
  const algorithm_type = document.getElementById("algo-type-select").value;
  const epsilon_value = slider_1.value;
  const minPts = document.getElementById("minPts").value;
  const manual_input_val = document.getElementById("manual_input").value;
  const Ifile = document.getElementById("filer");

  if (manual_input_val.trim() !== "" || Ifile.files.length > 0) {
    if (Ifile.files.length > 0) {
      // handle file input
      
      
      
      const post = {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        
        
        body: JSON.stringify(json_dict),
      };
      
      
      if(algorithm == "KM"){
        
        
        const json_dict = {
          "data":,
          "k":epsilon_value,
          "mode": algorithm_type,
        }
        fetch("https://baas-4ged.onrender.com/clustering/kmeans").then(response => response.json()).then(data => { console.log(data)}).catch(error => {
          console.error('Error: ', error);
        });
        
        
        
      }
      else{
        
        const json_dict = {
          "data": 
          "eps": epsilon_value,
          "min_sample":minPts,
          "mode": algorithm_type,
          
        };
        
        
        fetch("https://baas-4ged.onrender.com/clustering/dbscan").then(response => response.json()).then(data => {
          console.log(data)
        }).catch(error => {
          console.error('Error: ', error);
        })
        
        
      }
      
       
    }
    
    

    if (manual_input_val.trim() !== "") {
      // handle manual input
      
      
      const array_manual = manual_input_val.split(";");
      
      
        
      
      
      if(algorithm == "KM"){
        
        
        
      const json_dict = {
          "data": array_manual,
          "k": epsilon_value,
          "mode": algorithm_type,
          
        }
      
 
        fetch("https://baas-4ged.onrender.com/clustering/kmeans").then(response => response.json()).then(data => { console.log(data)}).catch(error => {
          console.error('Error: ', error);
        });
        
        
      }
      else{
        
        
        const json_dict = {
          "data": array_manual,
          "eps": epsilon_value,
          "min_sample":minPts,
          "mode": algorithm_type,
         
        };
        
        
        fetch("https://baas-4ged.onrender.com/clustering/dbscan").then(response => response.json()).then(data => {
          console.log(data)
        }).catch(error => {
          console.error('Error: ', error);
        })
        
        
      }
      
      
    }
  } else {
    alert("Please provide either manual input or a file.");
    return;
  }
});
      
      
      
    
    
  </script>
</body>
</html>
